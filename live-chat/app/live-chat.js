!function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=13)}([function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(t){i(this,e),this.socket=t.socket,this.messages=t.messages}return a(e,[{key:"sendMessage",value:function(e,t,n){var i={message:e,to:t};0!==e.length&&(this.socket.emit("new message",i),this.addMessage(i,!0,n))}},{key:"addMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments[2],i=!1,a="live-chat-message-their";if((t===!1&&e.to===n||t===!0)&&(i=e.message),t===!0&&(a="live-chat-message-mine"),i){var s=this.message(i,a);this.messages.appendChild(s)}}},{key:"addWarning",value:function(e){var t="live-chat-message-warning",n=this.message(e,t);this.messages.appendChild(n)}},{key:"message",value:function e(t,n){var e=document.createElement("li");return e.classList.add(n),e.innerHTML='<span class="live-chat-message-inner">'+t+"</span>",e}}]),e}();t.default=s},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}n(12);var a=n(10),s=i(a);new s.default},function(e,t,n){"use strict";function i(e,t){var n=t||0,i=a;return i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]}for(var a=[],s=0;s<256;++s)a[s]=(s+256).toString(16).substr(1);e.exports=i},function(e,t,n){"use strict";(function(t){var n,i=t.crypto||t.msCrypto;if(i&&i.getRandomValues){var a=new Uint8Array(16);n=function(){return i.getRandomValues(a),a}}if(!n){var s=new Array(16);n=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}e.exports=n}).call(t,n(5))},function(e,t,n){"use strict";function i(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var c=e.random||(e.rng||a)();if(c[6]=15&c[6]|64,c[8]=63&c[8]|128,t)for(var r=0;r<16;++r)t[i+r]=c[r];return t||s(c)}var a=n(3),s=n(2);e.exports=i},function(e,t,n){"use strict";var i,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":a(window))&&(i=window)}e.exports=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(7),r=i(c),o=n(0),l=i(o),u=function(){function e(t){a(this,e),this.screenID="backoffice",this.socket=t.socket,this.activeChats={},this.activeChatIndex=1,this.init()}return s(e,[{key:"init",value:function(){this.wrapper(),this.socketEvents(),this.bindUI()}},{key:"wrapper",value:function e(){var e=document.createElement("div");e.id="live-chat-backoffice",e.classList.add("live-chat-backoffice"),e.innerHTML='<div id="live-chat-backoffice-tabs" class="live-chat-backoffice-tabs"></div><div id="live-chat-backoffice-chats" class="live-chat-backoffice-chats"></div>',document.body.appendChild(e),this.tabs=document.getElementById("live-chat-backoffice-tabs"),this.chats=document.getElementById("live-chat-backoffice-chats")}},{key:"socketEvents",value:function(){var e=this;this.socket.on("new message",function(t){"undefined"==typeof e.activeChats[t.from]&&e.addNewClient(t.from),e.addMessage(t)}),this.socket.on("user left",function(t){"undefined"!=typeof e.activeChats[t.username]&&e.addWarning(e.activeChats[t.username])})}},{key:"bindUI",value:function(){var e=this;this.tabs.addEventListener("click",function(t){t.preventDefault();var n=t.target;n.classList.contains("live-chat-backoffice-tab")&&e.changeTab(n.href.split("#")[1],n)})}},{key:"bindUIs",value:function(e){var t=this;e.form.addEventListener("submit",function(n){n.preventDefault(),t.sendMessage(e)})}},{key:"changeTab",value:function(e,t){var n=this.chats.querySelector(".live-chat-session-active"),i=this.tabs.querySelector(".live-chat-tab-active");n.classList.remove("live-chat-session-active"),i.classList.remove("live-chat-tab-active"),document.getElementById(e).classList.add("live-chat-session-active"),t.classList.add("live-chat-tab-active"),t.querySelector(".live-chat-unread").innerHTML="",t.querySelector(".live-chat-unread").classList.remove("live-chat-has-unread")}},{key:"addNewClient",value:function(e){var t=e;this.activeChats[t]={screenID:t,index:this.activeChatIndex,screen:new r.default({screenID:t,index:this.activeChatIndex})};var n=document.getElementById("live-chat-"+t),i=n.querySelector(".live-chat-messages-list"),a=n.querySelector(".live-chat-message-form"),s=a.querySelector(".live-chat-message-input-item");this.activeChats[t]=Object.assign({},this.activeChats[t],{chat:new l.default({socket:this.socket,messages:i}),form:a,input:s}),this.bindUIs(this.activeChats[t]),this.activeChatIndex++}},{key:"sendMessage",value:function(e){e.chat.sendMessage(e.input.value,e.screenID,"backoffice"),e.input.value=""}},{key:"addMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.from,i=document.getElementById("live-chat-tab-"+n),a=i.querySelector(".live-chat-unread");this.activeChats[n].chat.addMessage(e,t,"backoffice"),i.classList.contains("live-chat-tab-active")||(a.innerHTML=1*a.innerHTML+1,a.classList.add("live-chat-has-unread"))}},{key:"addWarning",value:function(e){e.chat.addWarning("Client has left the conversation")}}]),e}();t.default=u},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s='<div class="live-chat-session">  <div class="live-chat-messages">      <ul class="live-chat-messages-list"></ul>  </div>  <div class="live-chat-message">      <form class="live-chat-message-form">          <label class="live-chat-message-input">              <input type="text" name="live-chat-message-input" class="live-chat-message-input-item" autocomplete="off" placeholder="Type your message here" />          </label>          <button class="live-chat-message-send">Send</button>      </form>  </div></div>',c=function(){function e(t){i(this,e),this.screenID=t.screenID,this.index=t.index,this.init()}return a(e,[{key:"init",value:function(){this.render(),this.addTab()}},{key:"render",value:function(){var e=document.getElementById("live-chat-backoffice-chats"),t=document.createElement("div"),n=e.querySelector(".live-chat-backoffice-wrapper");t.id="live-chat-"+this.screenID,t.classList.add("live-chat-backoffice-wrapper"),null===n&&t.classList.add("live-chat-session-active"),t.innerHTML=s,e.appendChild(t)}},{key:"addTab",value:function(){var e=document.getElementById("live-chat-backoffice-tabs"),t=document.createElement("a"),n=e.querySelector(".live-chat-backoffice-tab");t.classList.add("live-chat-backoffice-tab"),null===n&&t.classList.add("live-chat-tab-active"),t.href="#live-chat-"+this.screenID,t.id="live-chat-tab-"+this.screenID,t.innerHTML="Client "+this.index+'<span class="live-chat-unread"></span>',e.appendChild(t)}}]),e}();t.default=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(9),r=i(c),o=n(0),l=i(o),u=function(){function e(t){a(this,e),this.screenID=t.screenID,this.socket=t.socket,this.toggleClientScreen=this.toggleClientScreen.bind(this),this.init()}return s(e,[{key:"init",value:function(){this.screenUI=new r.default,this.getScreenElement(),this.chat=new l.default({socket:this.socket,messages:this.messages}),this.socket.emit("add user",this.screenID),this.bindEvents()}},{key:"getScreenElement",value:function(){this.wrapper=document.getElementById("live-chat"),this.toggle=this.wrapper.querySelector("#live-chat-toggle"),this.messages=this.wrapper.querySelector("#live-chat-messages-list"),this.form=this.wrapper.querySelector("#live-chat-message-form"),this.input=this.form.querySelector("#live-chat-message-input")}},{key:"bindEvents",value:function(){var e=this;this.toggle.addEventListener("click",this.toggleClientScreen),this.form.addEventListener("submit",function(t){t.preventDefault(),e.sendMessage()}),this.socket.on("new message",function(t){e.addMessage(t)})}},{key:"toggleClientScreen",value:function(){this.wrapper.classList.contains("live-chat-toggled")?this.wrapper.classList.remove("live-chat-toggled"):this.wrapper.classList.add("live-chat-toggled")}},{key:"sendMessage",value:function(){this.chat.sendMessage(this.input.value,"backoffice",this.screenID),this.input.value=""}},{key:"addMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.chat.addMessage(e,t,this.screenID)}}]),e}();t.default=u},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s='<div class="live-chat-header">  <h2 class="live-chat-toggle" id="live-chat-toggle">Need Help?</h2></div><div class="live-chat-session">  <div class="live-chat-messages">      <ul id="live-chat-messages-list"></ul>  </div>  <div class="live-chat-message">      <form id="live-chat-message-form">          <label class="live-chat-message-input">              <input type="text" name="live-chat-message-input" id="live-chat-message-input" autocomplete="off" class="live-chat-message-input-item" placeholder="Type your message here" />          </label>          <button class="live-chat-message-send" id="live-chat-message-send">Send</button>      </form>  </div></div>',c=function(){function e(){i(this,e),this.init()}return a(e,[{key:"init",value:function(){this.render()}},{key:"render",value:function(){var e=document.createElement("div");e.id="live-chat",e.classList.add("live-chat-wrapper"),e.innerHTML=s,document.body.appendChild(e)}}]),e}();t.default=c},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=n(11),r=i(c),o=n(8),l=i(o),u=n(6),f=i(u),d=n(4),h=function(){function e(){a(this,e),this.options=window.liveChatOptions,this.screenID=d(),this.socket=!1,this.init()}return s(e,[{key:"init",value:function(){var e=this;r.default.addResources(),setTimeout(function(){e.initializeSocket()},1e3)}},{key:"initializeSocket",value:function(){this.socket=window.io("//localhost:8090"),"client"===this.options.connection&&(this.screen=new l.default({socket:this.socket,screenID:this.screenID})),"backoffice"===this.options.connection&&(this.screen=new f.default({socket:this.socket}))}}]),e}();t.default=h},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function(){function e(){i(this,e)}return a(e,null,[{key:"addResources",value:function(){this.addSocket(),this.addStyles()}},{key:"addSocket",value:function(){var e=document.createElement("script"),t=document.getElementById("liveChat-script");e.src="//localhost:8090/socket.io/socket.io.js",t.parentNode.insertBefore(e,t)}},{key:"addStyles",value:function(){var e=document.createElement("link"),t="8090";e.rel="stylesheet",e.type="text/css",e.href="//localhost:"+t+"/live-chat.css",document.getElementsByTagName("head")[0].appendChild(e)}}]),e}();t.default=s},function(e,t){},function(e,t,n){e.exports=n(1)}]);